{"version":3,"sources":["webpack:///./src/views/ListSquare.vue?d412","webpack:///./src/views/ListSquare.vue","webpack:///./src/views/ListSquare.vue?e647","webpack:///./src/assets/image/loading.gif"],"names":["class","src","ref","showLoading","$router","back","iconName","switchTag","$event","hotPlaylistTags","item","index","currentIndex","key","id","name","touchstart","touchmove","touchend","lists","taglist","scrollSection","playlists","list","to","coverImgUrl","alt","playCount","components","Icon","data","touchstartX","touchstartY","lastLocation","scrollId","distanceX","distanceY","scrollSectionId","created","res","console","log","tags","filter","tag","length","forEach","ele","offset","limit","listRes","this","methods","event","clearTimeout","setTimeout","target","scrollHeight","scrollTop","clientHeight","concat","scrollTo","top","behavior","$refs","real","style","transition","targetTouches","pageX","pageY","parseFloat","getComputedStyle","getPropertyValue","match","Math","abs","left","switchTo","min","max","num","toFixed","nav","clientWidth","scrollLeft","offsetLeft","children","main","tagName","parseInt","getAttribute","render","__scopeId","module","exports"],"mappings":"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","file":"js/chunk-5f62ab4d.b9436c06.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./ListSquare.vue?vue&type=style&index=0&id=3fd8e875&lang=less&scoped=true\"","<template>\r\n  <div class=\"ListSquare\">\r\n    <img v-show=\"showLoading\"\r\n         class=\"loading\"\r\n         src=\"@/assets/image/loading.gif\">\r\n    <header>\r\n      <div class=\"back\"\r\n           @click=\"$router.back()\">\r\n        <icon iconName='icon-fanhuizuojiantou'></icon>\r\n        <div class=\"title\">\r\n          歌单广场\r\n        </div>\r\n      </div>\r\n    </header>\r\n    <nav ref='nav'\r\n         @click=\"switchTag($event)\">\r\n      <span :index='index'\r\n            :class=\"{ active : index === currentIndex}\"\r\n            v-for=\"(item, index) in hotPlaylistTags\"\r\n            :key=\"item.id\">\r\n        {{item.name}}\r\n      </span>\r\n    </nav>\r\n\r\n    <main ref='main'\r\n          @touchstart='touchstart'\r\n          @touchmove='touchmove'\r\n          @touchend='touchend'>\r\n      <div ref=\"real\"\r\n           class=\"real\">\r\n        <section v-for=\"(taglist, index) in lists\"\r\n                 :key=\"taglist.id\">\r\n          <!-- <div class=\"space\">占位</div> -->\r\n          <article @scroll=\"scrollSection\">\r\n            <router-link :to=\"{path:'/listview', query:{id:list.id}}\"\r\n                         class=\"card\"\r\n                         v-for=\"(list, index) in taglist.playlists\"\r\n                         :key=\"list.id\">\r\n              <img :src=\"list.coverImgUrl\"\r\n                   alt=\"list.name\">\r\n              <div class=\"name\">{{list.name}}</div>\r\n              <div class=\"count\">\r\n                <icon iconName=\"icon-play\"></icon>\r\n                {{playCount(list.playCount)}}\r\n              </div>\r\n            </router-link>\r\n          </article>\r\n        </section>\r\n      </div>\r\n    </main>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Icon from '@/components/Icon.vue';\r\nimport { getPlaylistHot, getTopPlaylist } from '@/api/index.js';\r\n\r\nexport default {\r\n  components: { Icon },\r\n  data () {\r\n    return {\r\n      hotPlaylistTags: [],\r\n      currentIndex: 0,\r\n      touchstartX: 0,\r\n      touchstartY: 0,\r\n      showLoading: false,\r\n\r\n      lastLocation: 0,\r\n      scrollId: 0,\r\n      distanceX: 0,\r\n      distanceY: 0,\r\n      scrollSectionId: 0,\r\n      lists: []\r\n    }\r\n  },\r\n  async created () {\r\n    let res = await getPlaylistHot();\r\n    console.log(res);\r\n    this.hotPlaylistTags = res.data.tags.filter((tag) => {\r\n      return tag.name.length < 4;\r\n    });\r\n    this.hotPlaylistTags.forEach(async (ele, index) => {\r\n      this.lists[index] = {\r\n        offset: 0,\r\n        limit: 12,\r\n        tag: ele.name,\r\n      };\r\n      let listRes = await getTopPlaylist({\r\n        limit: this.lists[index].limit,\r\n        offset: this.lists[index].offset++,\r\n        tag: this.lists[index].tag\r\n      });\r\n      // console.log(listRes);\r\n      this.lists[index].playlists = listRes.data.playlists;\r\n    });\r\n  },\r\n\r\n  methods: {\r\n    async scrollSection (event) {\r\n      if (this.scrollSectionId !== 0) {\r\n        clearTimeout(this.scrollSectionId);\r\n      }\r\n      this.scrollSectionId = setTimeout(async () => {\r\n        let target = event.target;\r\n        let scrollHeight = target.scrollHeight;\r\n        let scrollTop = target.scrollTop;\r\n        let clientHeight = target.clientHeight;\r\n        if (scrollHeight - 60 <= scrollTop + clientHeight) {\r\n          this.showLoading = true;\r\n          let listRes = await getTopPlaylist({\r\n            limit: this.lists[this.currentIndex].limit,\r\n            offset: this.lists[this.currentIndex].limit * this.lists[this.currentIndex].offset++,\r\n            tag: this.lists[this.currentIndex].tag\r\n          });\r\n          this.showLoading = false;\r\n\r\n          console.log(listRes.data.playlists);\r\n          this.lists[this.currentIndex].playlists = this.lists[this.currentIndex].playlists.concat(listRes.data.playlists);\r\n          setTimeout(() => {\r\n            target.scrollTo({\r\n              top: target.scrollTop + 100,\r\n              behavior: 'smooth'\r\n            });\r\n          }, 0);\r\n\r\n        }\r\n        this.scrollSectionId = 0;\r\n      }, 20);\r\n    },\r\n    touchstart (event) {\r\n      console.log('touchstart');\r\n      this.$refs.real.style.transition = 'none';\r\n      this.touchstartX = event.targetTouches[0].pageX;\r\n      this.touchstartY = event.targetTouches[0].pageY;\r\n      this.lastLocation = parseFloat(getComputedStyle(this.$refs.real).getPropertyValue('left').match(/[+-]?[0-9]+/)[0]);\r\n    },\r\n    touchmove (event) {\r\n      // console.log([this.$refs.real]);\r\n      this.distanceX = event.targetTouches[0].pageX - this.touchstartX;\r\n      this.distanceY = event.targetTouches[0].pageY - this.touchstartY;\r\n\r\n      if (Math.abs(this.distanceY) * 2 < Math.abs(this.distanceX)) {\r\n        this.$refs.real.style.left = (this.lastLocation + this.distanceX) + 'px';\r\n      }\r\n      // console.log(distanceX, this.lastLocation);\r\n      // this.$refs.main.scrollLeft = this.$refs.main.scrollLeft + \r\n    },\r\n\r\n    touchend () {\r\n      if (Math.abs(this.distanceY) * 2 < Math.abs(this.distanceX)) {\r\n        this.$refs.real.style.transition = 'left 0.3s ease-out'\r\n        if (this.distanceX < 0) {\r\n          this.switchTo(Math.min(this.currentIndex + 1, this.lists.length - 1));\r\n        } else {\r\n          this.switchTo(Math.max(0, this.currentIndex - 1));\r\n        }\r\n      } else {\r\n        this.switchTo(this.currentIndex);\r\n      }\r\n    },\r\n    playCount (num) {\r\n      let res = num;\r\n      if (num >= 100000000) {\r\n        res = num / 100000000;\r\n        res = res.toFixed(2) + '亿';\r\n      } else if (num >= 10000) {\r\n        res = num / 10000;\r\n        res = res.toFixed(2) + '万'\r\n      }\r\n      return res;\r\n    },\r\n    switchTo (index) {\r\n      // if (index === this.currentIndex) {\r\n      //   return;\r\n      // }\r\n      //nav switch\r\n      let nav = this.$refs.nav;\r\n      let clientWidth = nav.clientWidth;\r\n      let scrollLeft = nav.scrollLeft;\r\n\r\n      this.currentIndex = index;\r\n      let offsetLeft = nav.children[index].offsetLeft;\r\n\r\n      console.log(clientWidth, scrollLeft, offsetLeft);\r\n      // target.parentElement.scrollLeft = offsetLeft - 151;\r\n\r\n      nav.scrollTo({\r\n        left: offsetLeft - 151,\r\n        behavior: 'smooth'\r\n      });\r\n\r\n      // real switch\r\n      this.$refs.real.style.left = `-${index * this.$refs.main.clientWidth}px`;\r\n      console.log('switch ' + index);\r\n    },\r\n    switchTag (event) {\r\n      if (event.target.tagName === 'SPAN') {\r\n        let target = event.target;\r\n        this.switchTo(parseInt(target.getAttribute('index')));\r\n      }\r\n    },\r\n  }\r\n  // offsetHeight: 20\r\n  // offsetLeft: 85\r\n  // offsetParent: body\r\n  // offsetTop: 46\r\n  // offsetWidth: 30\r\n\r\n  // offsetHeight: 20\r\n  // offsetLeft: 15\r\n  // offsetParent: body\r\n  // offsetTop: 46\r\n  // offsetWidth: 30\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.ListSquare {\r\n  width: 100vw;\r\n  height: calc(100vh - 1.2rem);\r\n  background-color: rgb(58, 58, 58);\r\n\r\n  .loading {\r\n    background-color: rgba(255, 255, 255, 0.2);\r\n    border-radius: 20%;\r\n    position: fixed;\r\n    z-index: 1;\r\n    left: 50%;\r\n    top: 50%;\r\n    transform: translate(-50%, -50%);\r\n    width: 2rem;\r\n    height: 2rem;\r\n    object-fit: cover;\r\n  }\r\n  header {\r\n    padding-top: 0.2rem;\r\n    .back {\r\n      color: white;\r\n      display: flex;\r\n      align-items: center;\r\n      .icon {\r\n        margin: 0 0.2rem 0 0.2rem;\r\n        fill: white;\r\n      }\r\n      .title {\r\n        font-size: 0.4rem;\r\n      }\r\n    }\r\n  }\r\n\r\n  nav {\r\n    height: 0.8rem;\r\n    width: 90vw;\r\n    padding: 0.2rem 0.3rem;\r\n    overflow: scroll;\r\n    transition: all 1s;\r\n    &::-webkit-scrollbar {\r\n      display: none;\r\n    }\r\n\r\n    display: flex;\r\n    color: rgb(156, 156, 156);\r\n    gap: 0.4rem;\r\n    span {\r\n      font-size: 0.3rem;\r\n      white-space: nowrap;\r\n      padding-left: 0.2rem;\r\n      padding-right: 0.2rem;\r\n\r\n      &.active {\r\n        color: white;\r\n        font-weight: 600;\r\n        border-bottom: 0.1rem solid red;\r\n        border-bottom-left-radius: 10%;\r\n        border-bottom-right-radius: 10%;\r\n      }\r\n    }\r\n  }\r\n\r\n  main {\r\n    width: 100vw;\r\n    height: calc(100vh - 3rem);\r\n    position: fixed;\r\n    top: 1.8rem;\r\n    left: 0;\r\n    overflow: hidden;\r\n    &::-webkit-scrollbar {\r\n      display: none;\r\n    }\r\n    -webkit-overflow-scrolling: auto;\r\n\r\n    .real {\r\n      display: flex;\r\n      position: relative;\r\n      section {\r\n        position: relative;\r\n        // left: 2rem;\r\n        width: 7.5rem;\r\n        padding-left: 0.2rem;\r\n        padding-right: 0.2rem;\r\n        .space {\r\n          height: 1rem;\r\n        }\r\n        article {\r\n          width: 7.1rem;\r\n          height: calc(100vh - 3rem);\r\n          display: grid;\r\n          overflow-x: hidden;\r\n          overflow-y: auto;\r\n          grid-row-gap: 0.2rem;\r\n          grid-template-columns: repeat(3, 1fr);\r\n          &::-webkit-scrollbar {\r\n            display: none;\r\n          }\r\n          .card {\r\n            display: flex;\r\n            position: relative;\r\n            flex-direction: column;\r\n            width: 2.2rem;\r\n            height: auto;\r\n            margin: 0 0.2rem 0 0;\r\n\r\n            img {\r\n              width: 2.2rem;\r\n              height: 2.2rem;\r\n              border-radius: 0.2rem;\r\n            }\r\n\r\n            .name {\r\n              width: 100%;\r\n              height: 0.6;\r\n              font-size: 0.24rem;\r\n              line-height: 0.4rem;\r\n              color: white;\r\n\r\n              overflow: hidden;\r\n              text-overflow: ellipsis;\r\n              display: -webkit-box;\r\n              -webkit-line-clamp: 2;\r\n              -webkit-box-orient: vertical;\r\n            }\r\n\r\n            .count {\r\n              color: #ccc;\r\n              position: absolute;\r\n              right: 0.1rem;\r\n              top: 0.1rem;\r\n              font-size: 0.24rem;\r\n              display: flex;\r\n              align-items: center;\r\n              border-radius: 0.1rem;\r\n              background-color: rgba(27, 27, 27, 0.2);\r\n\r\n              icon {\r\n                fill: red;\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>","import { render } from \"./ListSquare.vue?vue&type=template&id=3fd8e875&scoped=true\"\nimport script from \"./ListSquare.vue?vue&type=script&lang=js\"\nexport * from \"./ListSquare.vue?vue&type=script&lang=js\"\n\nimport \"./ListSquare.vue?vue&type=style&index=0&id=3fd8e875&lang=less&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-3fd8e875\"\n\nexport default script","module.exports = __webpack_public_path__ + \"img/loading.12def9b0.gif\";"],"sourceRoot":""}